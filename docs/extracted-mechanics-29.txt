// Web Audio Morph POC: Flipper to Tidal Scar
const audioCtx = new AudioContext();
const morph = () => {
  // Base: Flipper whoosh (sine swell)
  const osc1 = audioCtx.createOscillator(); osc1.type = 'sine'; osc1.frequency.setValueAtTime(200, audioCtx.currentTime); // Low hum
  const gain1 = audioCtx.createGain(); gain1.gain.setValueAtTime(0.3, audioCtx.currentTime); gain1.gain.exponentialRampToValueAtTime(0.1, audioCtx.currentTime + 0.5);
  osc1.connect(gain1).connect(audioCtx.destination);
  osc1.start();

  // Twist: Void gurgle (noise + low-pass, Perlin-mod pitch)
  const buffer = audioCtx.createBuffer(1, audioCtx.sampleRate * 0.5, audioCtx.sampleRate);
  const data = buffer.getChannelData(0);
  for (let i = 0; i < data.length; i++) data[i] = Math.random() * 2 - 1; // White noise
  const noise = audioCtx.createBufferSource(); noise.buffer = buffer;
  const filter = audioCtx.createBiquadFilter(); filter.type = 'lowpass'; filter.frequency.setValueAtTime(150, audioCtx.currentTime);
  const perlinMod = (t) => 0.5 + 0.5 * Math.sin(t * 0.1 + Math.random() * Math.PI); // Simple Perlin tease
  filter.frequency.setTargetAtTime(100 + perlinMod(0) * 100, audioCtx.currentTime + 0.25, 0.1); // Darken over morph
  noise.connect(filter).connect(gain1); noise.start(audioCtx.currentTime + 0.25); // Delay blend

  gain1.gain.exponentialRampToValueAtTime(0.05, audioCtx.currentTime + 1); // Fade ache
};

// Trigger on morph event
morph(); // Haptic sync: light throb easing to rumble