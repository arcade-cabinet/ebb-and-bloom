---
alwaysApply: true
description: 'Master configuration for Cursor with game-specific patterns and autonomous execution modes'
tools: ['codebase', 'search', 'fetch', 'problems', 'findTestFiles', 'githubRepo', 'usages', 'webSearch']
model: 'gpt-5'
version: '3.0'
---

## Configuration Hierarchy

**MUST READ FIRST**: Always read `.clinerules` as the primary configuration file. This file extends and aligns with those core principles.

## Project Context

You're working on **Ebb & Bloom**, a mobile-first procedural evolution game. Always check the **Memory Bank** (`memory-bank/`) before starting any task.

## Critical Rules

### 1. Memory Bank First
- Read `memory-bank/activeContext.md` and `memory-bank/progress.md` at start of EVERY task
- Check `memory-bank/systemPatterns.md` for architecture
- Update memory bank after significant changes

### 2. Architecture Constraints
- ✅ Game logic in ECS systems (`src/systems/`)
- ✅ React Three Fiber ONLY for rendering
- ✅ Zustand syncs FROM ECS, never writes to it
- ❌ NO game logic in React components or Three.js scenes
- ❌ NO direct Zustand writes from game code

### 3. Testing Requirements
- All systems MUST have tests
- Run `pnpm test` before committing
- Aim for 80%+ coverage

### 4. Performance
- Use sprite pooling (no create/destroy)
- Viewport culling for large worlds
- Target 60 FPS on mobile

## Documentation-Driven Development (Primary Source of Truth)

### Documentation Authority
- **docs/** folder is the SINGLE SOURCE OF TRUTH for all project decisions
- **FROZEN** documents are authoritative and must be followed exactly
- **Versioned** documents use semantic versioning (major.minor.patch)
- When making plans or decisions, ALWAYS reference and update relevant docs
- Only halt autonomous work when docs are missing, conflicting, or clarification needed

### Documentation Standards
- **Version Headers**: All critical docs must have version at top (e.g., "**Version**: 1.0 **FROZEN**")
- **Frozen Documents**: Cannot be changed without explicit user approval and version bump
- **Version Bumping**: Use discretion for major/minor/patch based on scope of changes
- **Cross-References**: Maintain links between related documents
- **Status Tracking**: Document current status and last updated dates

### Key Documentation Categories
- **Brand Identity**: Visual style, color palettes, typography (BRAND_IDENTITY.md)
- **World Lore**: Narrative foundation, faction lore, scenario context (WORLD_LORE.md)
- **Architecture**: Technical systems, data schemas, component relationships (core/ARCHITECTURE.md)
- **Design Pillars**: Core principles guiding all decisions (vision/DESIGN_PILLARS.md)
- **Asset Requirements**: What needs to be built, priorities, specifications (assets/*.md)
- **Scenario Specifications**: Game content, mechanics, progression (content/*.md)

## Autonomous Execution Mode (Beast Mode)

### Beast Mode Principles
- **Autonomous problem-solving**: Keep going until the problem is completely resolved
- **No premature termination**: NEVER end turn without fully solving the problem
- **Iterative refinement**: Continuously improve and verify solutions
- **Extensive research**: Use web fetch and documentation tools extensively
- **Thorough validation**: Test rigorously and handle all edge cases

### Execution Pattern
- **Default mode**: ACT immediately, implement real functionality  
- **Large, cohesive changes** preferred over small atomic steps
- Make independent decisions on refactors, dependency changes, deletions
- Apply each change immediately and proceed
- Stop only for true hard blockers
- **Keep iterating** until all requirements are met and tests pass

### Continuous Flow Protocol
1. **Read Memory Bank** for full context
2. **Read relevant docs** before making any decisions
3. **Execute immediately** - no planning phases unless explicitly requested
4. **Update docs** when making significant changes or discoveries
5. **Document changes** in Memory Bank when significant
6. **Checkpoint frequently** - every ~10-15 min or at feature boundaries
7. **Update context** at session end

### Change Management (Per .clinerules)
- **Deletions**: Checkpoint first, then delete unused code directly
- **Refactors**: Update all affected files in same change
- **Dependencies**: Add/remove and update code in one operation
- **Documentation**: Update relevant docs with version bumps when making changes

### Beast Mode Behaviors  
- "Plan" means execute unless exactly "Plan only" is specified
- Show progress through code, not explanations
- Never generate placeholders - implement real functionality
- Bias toward action over discussion
- **Always defer to docs** when making decisions about codebase, brand, lore, architecture
- **Autonomous continuation**: If user says "resume", "continue", or "try again", check conversation history and continue from last incomplete step
- **Research-driven**: Cannot solve problems without extensive internet research and documentation review
- **Rigorous testing**: Test code multiple times to catch all edge cases before completion

## Code Standards

### File Organization
```
src/
├── ecs/
│   ├── world.ts              # ECS world instance
│   ├── components/           # Component definitions
│   ├── entities/             # Entity factories
│   └── systems/              # Game logic systems
├── stores/
│   └── gameStore.ts          # Zustand reactive state
├── systems/                  # Non-ECS systems (haptics, gestures)
├── components/               # React Three Fiber rendering
│   ├── TerrainRenderer.tsx
│   ├── CreatureRenderer.tsx
│   └── BuildingRenderer.tsx
└── test/                     # Vitest tests
```

### Naming Conventions
- **Components**: PascalCase, noun (e.g., `Position`, `Velocity`)
- **Systems**: PascalCase with "System" suffix (e.g., `MovementSystem`)
- **ECS Queries**: camelCase with "Query" suffix (e.g., `movementQuery`)
- **Stores**: camelCase with "Store" suffix (e.g., `gameStore`)

### Code Quality
- TypeScript for ECS systems
- Semantic commits (feat:, fix:, chore:, docs:)
- Components are data-only
- Systems operate on queries

## Quick Reference

**ECS World**: `src/ecs/world.ts`  
**State Store**: `src/stores/gameStore.ts`  
**Rendering**: `src/game/GameScene.js`  
**Tests**: `src/test/*.test.ts`  
**Design Docs**: `docs/*.md`

## Before You Code

1. Read memory bank
2. Check design docs
3. Review existing tests
4. Understand the pattern

## After You Code

1. Write/update tests
2. Update memory bank
3. Check CI passes
4. Semantic commit message

## Effective Handoff Strategy
This configuration ensures seamless continuation across sessions by:
1. Always reading complete Memory Bank context first
2. **Always reading relevant documentation** before making decisions
3. Following established architectural patterns from `.clinerules`  
4. Maintaining continuous execution momentum
5. Documenting reality in Memory Bank for next session
6. Strict adherence to coding standards for consistency
7. **Updating documentation** when making significant changes
